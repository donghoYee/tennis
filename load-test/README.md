# 🏓 Tennis Tournament Load Testing

동시 100명 접속 상황을 시뮬레이션하여 시스템 성능을 측정하는 부하 테스트 도구입니다.

## 🚀 빠른 시작

```bash
cd /home/daniel/Projects/tennis/load-test
./run-tests.sh
```

## 📋 테스트 종류

### 1. 읽기 테스트 (Read Test)
- **목적**: GET 요청 집중 부하 테스트
- **시뮬레이션**: 100명이 동시에 토너먼트 목록 조회
- **측정 지표**: 응답시간, 처리량, 성공률

### 2. 쓰기 테스트 (Write Test)
- **목적**: POST/PUT 요청 집중 부하 테스트
- **시뮬레이션**: 100명이 동시에 토너먼트 생성 및 팀 이름 변경
- **측정 지표**: 응답시간, 처리량, 성공률, 데이터 일관성

### 3. Socket.IO 테스트
- **목적**: 실시간 통신 부하 테스트
- **시뮬레이션**: 100명이 동시에 WebSocket 연결 및 실시간 이벤트 수신
- **측정 지표**: 연결시간, 메시지 지연시간, 연결 안정성

### 4. 혼합 테스트 (Mixed Test)
- **목적**: 실제 사용 패턴 시뮬레이션
- **구성**: 읽기 50% + 쓰기 30% + Socket.IO 20%
- **시뮬레이션**: 다양한 사용 패턴의 100명 동시 접속

## 📊 측정 지표

### 응답 시간 (Response Time)
- **평균 응답시간**: 모든 요청의 평균 처리 시간
- **95th Percentile**: 95%의 요청이 이 시간 내에 처리됨
- **99th Percentile**: 99%의 요청이 이 시간 내에 처리됨

### 처리량 (Throughput)
- **RPS (Requests Per Second)**: 초당 처리 요청 수
- **동시 연결 수**: 동시에 유지되는 연결 수

### 안정성 (Reliability)
- **성공률**: 전체 요청 중 성공한 요청의 비율
- **에러율**: 실패한 요청의 비율과 에러 유형

## 🎯 테스트 시나리오

### 시나리오 1: 일반적인 사용 패턴
```
50명: 토너먼트 목록 조회 (읽기)
30명: 토너먼트 생성/수정 (쓰기)
20명: 실시간 경기 관람 (Socket.IO)
```

### 시나리오 2: 피크 시간 패턴
```
100명: 동시에 토너먼트 목록 조회
→ 대회 시작 전 몰리는 시간대 시뮬레이션
```

### 시나리오 3: 관리자 작업 집중
```
100명: 동시에 토너먼트 생성 및 관리 작업
→ SQLite 데이터베이스 쓰기 병목 테스트
```

## 📈 예상 성능 기준

### 정상 범위 (Good)
- 평균 응답시간: < 200ms
- 95th Percentile: < 500ms
- 성공률: > 99%
- RPS: > 50

### 주의 범위 (Warning)
- 평균 응답시간: 200-1000ms
- 95th Percentile: 500-2000ms
- 성공률: 95-99%
- RPS: 20-50

### 문제 범위 (Critical)
- 평균 응답시간: > 1000ms
- 95th Percentile: > 2000ms
- 성공률: < 95%
- RPS: < 20

## 🔧 실행 방법

### 1. 개별 테스트 실행
```bash
# 읽기 테스트만
npm run test:read

# 쓰기 테스트만
npm run test:write

# Socket.IO 테스트만
npm run test:socket

# 혼합 테스트만
npm run test:mixed
```

### 2. 대화형 메뉴 실행
```bash
./run-tests.sh
```

### 3. 모든 테스트 순차 실행
```bash
npm run test:all
```

## 📋 사전 요구사항

1. **서버 실행 상태 확인**
   ```bash
   curl http://localhost:5678/api/tournaments
   ```

2. **Docker 컨테이너 상태 확인**
   ```bash
   docker ps
   ```

3. **시스템 리소스 확인**
   ```bash
   free -h
   htop
   ```

## 🚨 주의사항

### 테스트 중 모니터링
- CPU 사용률
- 메모리 사용량
- 디스크 I/O
- 네트워크 연결 수

### 테스트 후 정리
- 생성된 테스트 데이터는 자동으로 정리됩니다
- 실패한 경우 수동으로 데이터 정리가 필요할 수 있습니다

### 운영 환경 주의
- 이 테스트는 개발/테스트 환경에서만 실행하세요
- 운영 환경에서 실행 시 실제 서비스에 영향을 줄 수 있습니다

## 📁 파일 구조

```
load-test/
├── package.json          # 의존성 및 스크립트
├── run-tests.sh          # 대화형 테스트 실행기
├── README.md             # 이 파일
└── tests/
    ├── read-test.js      # 읽기 부하 테스트
    ├── write-test.js     # 쓰기 부하 테스트
    ├── socket-test.js    # Socket.IO 부하 테스트
    └── mixed-test.js     # 혼합 부하 테스트
```

## 🎯 다음 단계

테스트 결과를 바탕으로 다음과 같은 최적화를 고려할 수 있습니다:

1. **SQLite → PostgreSQL 전환**
2. **Node.js 클러스터링 적용**
3. **Socket.IO Redis Adapter 설정**
4. **연결 풀 최적화**
5. **캐싱 전략 수립**
